swagger: "2.0"
info:
  title: ITP Server API
  description: Inspur Testing Platform autogenerated API document.
  version: 1.0.0
  termsOfService: http://git.inspur.com/wangkun_lc/itpserver
  contact:
    email: wangkun_lc@inspur.com
basePath: /v1
paths:
  /auth/:
    get:
      tags:
      - auth
      description: Returns token info registered from Keycloak.
      operationId: AuthController.Get
      responses:
        "200":
          description: "{string} \tSuccessful returned token info from Keycloak."
        "400":
          description: Bad request.
        "401":
          description: Unauthorized.
        "403":
          description: The resouce specified was forbidden to access.
        "404":
          description: The resource specified was not found.
        "500":
          description: Internal error occurred at server side.
  /installations/:
    get:
      tags:
      - installations
      description: Get virtual machines with software packages installed.
      operationId: InstallationController.Get
      parameters:
      - in: header
        name: Authorization
        description: Set authorization info.
        required: true
        type: string
      - in: query
        name: vm_name
        description: The virtual machine ID which installed software packages.
        required: true
        type: string
      responses:
        "200":
          description: "{string} \tSuccessful get virtual machines with software package
            installed."
        "400":
          description: Bad request.
        "401":
          description: Unauthorized.
        "403":
          description: The resouce specified was forbidden to access.
        "404":
          description: The resource specified was not found.
        "500":
          description: Internal error occurred at server side.
  /installations/{vm_name}:
    post:
      tags:
      - installations
      description: Install selected software packages onto a virtual machine.
      operationId: InstallationController.Post
      parameters:
      - in: header
        name: Authorization
        description: Set authorization info.
        required: true
        type: string
      - in: path
        name: vm_name
        description: The virtual machine name which wants to install software packages.
        required: true
        type: string
      - in: body
        name: pkg
        description: The virtual machine ID which wants to install software packages.
        required: true
        schema:
          $ref: '#/definitions/models.PackageVO'
      responses:
        "200":
          description: "{string} \tSuccessful installed software package onto a virtual
            machine."
        "400":
          description: Bad request.
        "401":
          description: Unauthorized.
        "403":
          description: The resouce specified was forbidden to access.
        "404":
          description: The resource specified was not found.
        "500":
          description: Internal error occurred at server side.
    delete:
      tags:
      - installations
      description: Delete selected virtual machine which with software package installed.
      operationId: InstallationController.Delete
      parameters:
      - in: header
        name: Authorization
        description: Set authorization info.
        required: true
        type: string
      - in: path
        name: vm_name
        description: The virtual machine ID to be deleted.
        required: true
        type: string
      - in: query
        name: pkg_name
        description: The package name to be deleted on VM.
        required: true
        type: string
      - in: query
        name: pkg_tag
        description: The package tag to be deleted on VM.
        type: string
      responses:
        "200":
          description: "{string} \tSuccessful deleted virtual machine by ID."
        "400":
          description: Bad request.
        "401":
          description: Unauthorized.
        "403":
          description: The resouce specified was forbidden to access.
        "404":
          description: The resource specified was not found.
        "500":
          description: Internal error occurred at server side.
  /packages/:
    get:
      tags:
      - packages
      description: Return a list of software packages.
      operationId: PackagesController.Get
      parameters:
      - in: header
        name: Authorization
        description: Set authorization info.
        required: true
        type: string
      - in: query
        name: name
        description: The software package name to return
        type: string
      - in: query
        name: tag
        description: The software package tag to return
        type: string
      responses:
        "200":
          description: "{string} \t\tSuccessful get all or filter software packages
            by name."
        "400":
          description: Bad request.
        "401":
          description: Unauthorized.
        "403":
          description: The resouce specified was forbidden to access.
        "404":
          description: The resource specified was not found.
        "500":
          description: Internal error occurred at server side.
    post:
      tags:
      - packages
      description: Upload software package.
      operationId: PackagesController.Post
      parameters:
      - in: header
        name: Authorization
        description: Set authorization info.
        required: true
        type: string
      - in: formData
        name: vm_name
        description: The VM name to install package.
        required: true
        type: string
      - in: formData
        name: pkg
        description: The package to be uploaded.
        required: true
        type: file
      responses:
        "200":
          description: "{string} \t\tSuccessful submitted information about software
            package."
        "400":
          description: Bad request.
        "401":
          description: Unauthorized.
        "403":
          description: The resouce specified was forbidden to access.
        "404":
          description: The resource specified was not found.
        "500":
          description: Internal error occurred at server side.
    delete:
      tags:
      - packages
      description: Delete software package by name and tag.
      operationId: PackagesController.Delete
      parameters:
      - in: header
        name: Authorization
        description: Set authorization info.
        required: true
        type: string
      - in: query
        name: package_name
        description: The software package name to be deleted.
        required: true
        type: string
      - in: query
        name: package_tag
        description: The software package tag to be deleted.
        type: string
      responses:
        "200":
          description: "{string} \t\tSuccessful submitted information about software
            package."
        "400":
          description: Bad request.
        "401":
          description: Unauthorized.
        "403":
          description: The resouce specified was forbidden to access.
        "404":
          description: The resource specified was not found.
        "500":
          description: Internal error occurred at server side.
  /session/logout:
    get:
      tags:
      - session
      description: Log out and clean up Keycloak session.
      operationId: BaseController.Get
      responses:
        "200":
          description: "{string} \tSuccessful logged out and cleaned up Keycloak session."
        "400":
          description: Bad request.
        "401":
          description: Unauthorized.
        "403":
          description: The resouce specified was forbidden to access.
        "404":
          description: The resource specified was not found.
        "500":
          description: Internal error occurred at server side.
  /vms/:
    get:
      tags:
      - vms
      description: Returns a list of virtual machines or filtered by VM ID.
      operationId: VMController.Get
      parameters:
      - in: header
        name: Authorization
        description: Set authorization info.
        required: true
        type: string
      - in: query
        name: id
        description: The virual machine name to return.
        type: integer
        format: int64
      responses:
        "200":
          description: "{string} \tSuccessful get all or filter virtual machine by
            name."
        "400":
          description: Bad request.
        "401":
          description: Unauthorized.
        "403":
          description: The resouce specified was forbidden to access.
        "404":
          description: The resource specified was not found.
        "500":
          description: Internal error occurred at server side.
    post:
      tags:
      - vms
      description: Submit to create a virtual machine.
      operationId: VMController.Post
      parameters:
      - in: header
        name: Authorization
        description: Set authorization info.
        required: true
        type: string
      - in: body
        name: vm_with_spec
        description: The virual machine to submit.
        schema:
          $ref: '#/definitions/models.VMWithSpec'
      responses:
        "200":
          description: "{string} \tSuccessful submitted virtual machine."
        "400":
          description: Bad request.
        "401":
          description: Unauthorized.
        "403":
          description: The resouce specified was forbidden to access.
        "404":
          description: The resource specified was not found.
        "500":
          description: Internal error occurred at server side.
  /vms/{vm_name}:
    delete:
      tags:
      - vms
      description: Delete a virtual machine by ID.
      operationId: VMController.Delete
      parameters:
      - in: header
        name: Authorization
        description: Set authorization info.
        required: true
        type: string
      - in: query
        name: vm_name
        description: The virtual machine name to be deleted.
        required: true
        type: string
      responses:
        "200":
          description: "{string} \tSuccessful deleted virtual machine by name."
        "400":
          description: Bad request.
        "401":
          description: Unauthorized.
        "403":
          description: The resouce specified was forbidden to access.
        "404":
          description: The resource specified was not found.
        "500":
          description: Internal error occurred at server side.
definitions:
  models.Package:
    title: Package
    type: object
    properties:
      package_id:
        type: integer
        format: int64
      package_name:
        type: string
      package_tag:
        type: string
  models.PackageVO:
    title: PackageVO
    type: object
    properties:
      package_name:
        type: string
      package_tag:
        type: string
      source_name:
        type: string
  models.VM:
    title: VM
    type: object
    properties:
      id:
        type: integer
        format: int64
      vm_ip:
        type: string
      vm_name:
        type: string
      vm_os:
        type: string
      vm_spec:
        $ref: '#/definitions/models.VMSpec'
  models.VMSpec:
    title: VMSpec
    type: object
    properties:
      cpus:
        type: integer
        format: int32
      extras:
        type: string
      memory:
        type: string
      storage:
        type: string
      vid:
        type: string
  models.VMWithSpec:
    title: VMWithSpec
    type: object
    properties:
      vm_ip:
        type: string
      vm_name:
        type: string
      vm_os:
        type: string
      vm_spec:
        $ref: '#/definitions/models.VMSpec'
tags:
- name: vms
  description: |
    Operations about vm
